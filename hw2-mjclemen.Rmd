---
title: "hw2-mjclemen"
author: "Mandy Clemente"
date: "October 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
require(rgdal)
require(leaflet)
require(leaflet.extras)
require(dplyr)
require(readxl)
require(stringr)
require(tools)
# Read in spatial data
crimes <- read.csv("Crime_Incidents_in_the_Last_30_Days.csv")
crimes <- crimes[1:200,]
crimes$METHOD <- str_to_title(crimes$METHOD)
crimes$SHIFT <- str_to_title(crimes$SHIFT)
```

# Map with a layer of points

```{r}
leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.WorldStreetMap) %>%
  addCircleMarkers(lng = ~LONGITUDE, lat = ~LATITUDE, radius = 2)
```
# Map with a layer of lines
```{r}
leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%
  addPolylines(lng = ~LONGITUDE, lat = ~LATITUDE,
               color = "red",
               group = crimes$OFFENSE,
               weight = 2)
```
# Map with a layer of polygons
```{r}
leaflet(data = crimes) %>%
  addProviderTiles(providers$Stamen.Toner) %>%
  addPolygons(lng = ~LONGITUDE, lat = ~LATITUDE,
              weight = 2,
              color = "purple",
              label = "Crimes throughout DC",
              highlight = highlightOptions(weight = 3,
                                           color = "blue",
                                           bringToFront = TRUE))
```
# Map with a variable which changes of the color of the elements or the marker with an accompanying legend
```{r}

# Custom Palette
type.of.crime.colors <- colorFactor(
  palette = c('red', 'yellow', 'blue'),
  levels = c('Day', 'Evening', 'Midnight'))

leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.WorldStreetMap) %>%
  addCircleMarkers(data = crimes,
                   lng = ~LONGITUDE,
                   lat = ~LATITUDE,
                   radius = 2,
                   color = ~type.of.crime.colors(SHIFT)) %>%
  addLegend(position = 'topright',
            pal = type.of.crime.colors,
            values = crimes$SHIFT,
            title = 'Weapon')
```

