---
title: "hw2-mjclemen"
author: "Mandy Clemente"
date: "October 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
require(rgdal)
require(leaflet)
require(leaflet.extras)
require(dplyr)
require(readxl)
require(stringr)
require(tools)
# Read in spatial data
crimes <- read.csv("Crime_Incidents_in_the_Last_30_Days.csv")
crimes <- crimes[1:200,]
crimes$METHOD <- str_to_title(crimes$METHOD)
crimes$SHIFT <- str_to_title(crimes$SHIFT)
crimes$START_DATE <- as.Date(crimes$START_DATE)
crimes$DISTRICT <- as.factor(crimes$DISTRICT)
```

# Map with a layer of points

```{r}
leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.WorldStreetMap) %>%
  addCircleMarkers(lng = ~LONGITUDE, lat = ~LATITUDE, radius = 2)
```
# Map with a layer of lines
```{r}
leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%
  addPolylines(lng = ~LONGITUDE, lat = ~LATITUDE,
               color = "red",
               group = crimes$OFFENSE,
               weight = 2)
```
# Map with a layer of polygons
```{r}
crime.district <- colorFactor(topo.colors(5), crimes$DISTRICT)

leaflet(data = crimes) %>%
  addProviderTiles(providers$Stamen.Toner) %>%
  addPolygons(lng = ~LONGITUDE, lat = ~LATITUDE,
              color = ~crime.district(DISTRICT),
              stroke = FALSE, smoothFactor = 0.2, fillOpacity = 1,
              popup = DISTRICT) %>%
  addLegend(pal = crime.district, values = ~DISTRICT, title = "Color by District:",
  position = "bottomright")
```
# Map with a variable which changes of the color of the elements or the marker with an accompanying legend
```{r}

# Custom Palette
time.of.day.colors <- colorFactor(
  palette = c('red', 'yellow', 'blue'),
  levels = c('Day', 'Evening', 'Midnight'))

leaflet(data = crimes) %>%
  addProviderTiles(providers$Esri.WorldStreetMap) %>%
  addCircleMarkers(data = crimes,
                   lng = ~LONGITUDE,
                   lat = ~LATITUDE,
                   radius = 2,
                   color = ~time.of.day.colors(SHIFT)) %>%
  addLegend(position = 'topright',
            pal = time.of.day.colors,
            values = crimes$SHIFT,
            title = 'Time of Day')
```
# Map with functioning layersControl()
```{r}
leaflet(crimes) %>%
  # Two different base groups
  addProviderTiles(providers$Thunderforest, group = "Thunderforest") %>%
  addProviderTiles(providers$OpenWeatherMap, group = "OpenWeatherMap") %>%
  # Two different layers
  addCircles(lng = ~LONGITUDE, lat = ~LATITUDE, radius = crimes$PSA, stroke = F, group = "PSA", popup = ~PSA) %>%
  addCircles(data = crimes, lng = ~LONGITUDE, lat = ~LATITUDE,
    fill = F, weight = 3, color = "red", group = "Circle Outline") %>%
  # Layers control
  addLayersControl(
    baseGroups = c("Thunderforest", "OpenWeatherMap"),
    overlayGroups = c("PSA", "Circle Outline"),
    options = layersControlOptions(collapsed = FALSE)
  )
```

