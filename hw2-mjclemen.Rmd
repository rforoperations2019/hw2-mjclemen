---
title: "hw2-mjclemen"
author: "Mandy Clemente"
date: "October 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
require(rgdal)
require(leaflet)
require(leaflet.extras)
require(dplyr)
require(readxl)
require(stringr)
```

# Map with a layer of points

```{r}
# Read in spatial data
crimes <- read.csv("Crime_Incidents_in_the_Last_30_Days.csv")

crimes.circle.map <- leaflet(data = crimes[1:100,]) %>%
  addProviderTiles(providers$Esri.WorldStreetMap) %>%
  addCircleMarkers(lng = ~LONGITUDE, lat = ~LATITUDE)
```
# Map with a layer of lines
```{r}
leaflet(data = crimes[1:100,]) %>%
  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%
  addPolylines(lng = ~LONGITUDE, lat = ~LATITUDE, color = "red", group = crimes[1:100,"OFFENSE""])
```
# Map with a layer of polygons
```{r}
leaflet(data = crimes[1:100,]) %>%
  addProviderTiles(providers$Stamen.Toner) %>%
  addPolygons(lng = ~LONGITUDE, lat = ~LATITUDE,
              weight = 2,
              color = "purple",
              label = "Crimes throughout DC",
              highlight = highlightOptions(weight = 10,
                                           color = "blue",
                                           bringToFront = TRUE))
```
# Map with a variable which changes of the color of the elements or the marker with an accompanying legend
```{r}
# Custom Palette
type.of.crime.colors <- colorFactor(
  palette = c('red', 'blue', 'green'),
  levels = c('GUN', 'KNIFE', 'OTHERS'))

leaflet(data = crimes[1:100,]) %>%
  addProviderTiles(providers$OpenStreetMap) %>%
  addCircleMarkers(data = crimes[1:100,],
                   lng = ~LONGITUDE,
                   lat = ~LATITUDE,
                   radius = 2,
                   color = ~type.of.crime.colors(METHOD)) %>%
  addLegend(position = 'topright',
            pal = type.of.crime.colors,
            values = crimes[1:100,]$METHOD,
            title = "Weapon")
```

